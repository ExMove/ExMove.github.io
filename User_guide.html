<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.3.433" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="Alice Trevail" />
<meta name="author" content="Stephen Lang" />
<meta name="author" content="Luke Ozsanlav-Harris" />
<meta name="author" content="Liam Langley" />

<title>ExMove – ExMove user guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script  src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script  src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link  href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet" />
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


<link rel="stylesheet" href="styles.css" />
</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="/index.html">
    <span class="navbar-title">ExMove</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
  aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"
  onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="/index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="/User_guide.html" rel="" target="">
 <span class="menu-text">User guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="/Glossary.html" rel="" target="">
 <span class="menu-text">Glossary</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="/FAQs.html" rel="" target="">
 <span class="menu-text">FAQ&#39;s</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ExMove/ExMove" rel="" target=""><i 
  class="bi bi-github" 
  role="img" 
>
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ExMove user guide</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Alice Trevail <a href="https://orcid.org/0000-0002-6459-5213" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Stephen Lang <a href="https://orcid.org/0000-0001-5820-4346" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Luke Ozsanlav-Harris <a href="https://orcid.org/0000-0003-3889-6722" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
             <p>Liam Langley <a href="https://orcid.org/0000-0001-9754-6517" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
  
    
  </div>
  

</header>
<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction">Introduction</a></li>
  <li><a href="#pre-flight-checks" id="toc-pre-flight-checks">0. Pre-flight checks</a></li>
  <li><a href="#read-in-data-files" id="toc-read-in-data-files">1. Read in data files</a></li>
  <li><a href="#merge-with-metadata" id="toc-merge-with-metadata">2. Merge with metadata</a></li>
  <li><a href="#cleaning" id="toc-cleaning">3. Cleaning</a></li>
  <li><a href="#processing" id="toc-processing">4. Processing</a></li>
  <li><a href="#save-for-shiny" id="toc-save-for-shiny">5. Save for Shiny</a></li>
  <li><a href="#filtering" id="toc-filtering">6. Filtering</a>
  <ul>
  <li><a href="#shiny-app" id="toc-shiny-app">Accessing the Shiny app</a></li>
  </ul></li>
  <li><a href="#summarise-data" id="toc-summarise-data">7. Summarise cleaned &amp; filtered tracking data</a></li>
  <li><a href="#save-data" id="toc-save-data">8. Save filtered and summary data</a></li>
  <li><a href="#visualisation" id="toc-visualisation">9. Visualisation</a></li>
  </ul>
</nav>
<section id="introduction" class="level2">
<h2>Introduction</h2>
<p>This user guide can be used as a walkthrough for reading and processing tracking data files with the <code>Workflow.R</code> script. You can use the example datasets provided in <code>Data</code>, or try with your own tracking data (see <a href="#pre-flight-checks">Pre-flight checks</a> for details on data requirements and structure).</p>
<p>The following diagram gives an overview of the workflow (boxes link to relevant section):</p>
<div class="cell" data-fig-label="fig-1" data-fig-width="9" data-eval="true">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">%%{init:{&#39;flowchart&#39;:{&#39;nodeSpacing&#39;: 20, &#39;rankSpacing&#39;: 30}}}%%
flowchart LR
  S1[Read in data] ==&gt; S3(Merge)
  S2[Read in metadata] ==&gt; S3 ==&gt; A(Clean)
  subgraph shiny [&quot;(Parameter determination in Shiny app)&quot;]
  style shiny fill:#fbfbfb, stroke:#d3d3d3, stroke-width:px
  A(Clean) ==&gt; B(Process) ==&gt; C(Filter)
  D(Optional&lt;br/&gt;scripts)
  end
  C ==&gt; S{Standardised&lt;br/&gt;dataset}
  C --&gt; D --&gt; S
  S --&gt; E(Analyses)
  S ==&gt; F(Archive)
  linkStyle 6,7 stroke-dasharray: 4 4
%% NOTE: remember to update links for finalised user guide!!
  click S1 &quot;#read-in-data-files&quot;;
  click S2 &quot;#merge-with-metadata&quot;;
  click S3 &quot;#merge-with-metadata&quot;;
  click A &quot;#cleaning&quot;;
  click B &quot;#processing&quot;;
  click C &quot;#filtering&quot;;
  click S &quot;#save-data&quot;;
%%  click ? &quot;#summarise-data&quot;;
%%  click ? &quot;#visualisation&quot;;
</pre>
</div>
<p>Figure 1: Diagram of workflow used for analysing movement data (thick line denotes core path of code)</p>
</div>
</div>
</div>
<section id="dependencies" class="level4">
<h4>Dependencies:</h4>
<ul>
<li>This workflow uses the <a href="https://www.r-project.org/about.html">R programming language</a>, run via the <a href="https://www.rstudio.com/products/rstudio/">R Studio IDE</a></li>
<li>All code embraces the core principles of how to structure <a href="https://r4ds.had.co.nz/tidy-data.html">‘tidy data’</a></li>
<li>We use <a href="https://r4ds.had.co.nz/workflow-projects.html#rstudio-projects">RStudio projects</a> and the <a href="https://here.r-lib.org/"><code>here</code></a> package to build relative filepaths that are reproducible</li>
<li>Requires <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>, <a href="https://github.com/Rdatatable/data.table"><code>data.table</code></a>, <a href="https://r-spatial.github.io/sf/"><code>sf</code></a> and <a href="https://here.r-lib.org/"><code>here</code></a> packages to be installed</li>
<li>Use our example data sets in the Data folder (RFB_IMM, RFB, GWFG, TRPE) or provide your own data</li>
</ul>
</section>
<section id="user-inputs" class="level4">
<h4>User inputs</h4>
<p>Some code chunks require editing by the user to match the specific dataset being used (particularly if you are using your own data), and are highlighted as below (the 🧠 indicates you will need to think about the structure and format of your data when making these edits!):</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## USER INPUT START ##</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------#</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>example_input <span class="ot">&lt;-</span> <span class="st">&quot;uservalue&quot;</span> <span class="co"># In the R code, user input sections appear like this</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## USER INPUT </span><span class="re">END</span><span class="do"> ##</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------#</span></span></code></pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="pre-flight-checks" class="level2">
<h2>0. Pre-flight checks</h2>
<section id="how-to-use-this-workflow" class="level5">
<h5>How to use this workflow:</h5>
<ul>
<li>We will inspect the data before reading it in, so there is no need to open it in another program (e.g., excel, which can corrupt dates and times)</li>
<li>User-defined parameters (see <a href="#user-inputs">user inputs</a>) are called within the subsequent processing steps</li>
<li>Where you see: <code>## ** Option ** ##</code>, there is an alternative version of the code to fit some common alternative data formats</li>
<li>Throughout, we will use some key functions to inspect the data (e.g., <code>head</code> for top rows, <code>str</code> for column types, and <code>names</code> for column names)</li>
</ul>
</section>
<section id="data-and-directory-structure" class="level5">
<h5>Data and directory structure:</h5>
<ul>
<li>Data files should all be stored within the <code>Data</code> folder</li>
<li>Folders and files are best named in <code>snakecase_format</code> as spaces in filepaths can cause issues</li>
<li>Tracking data for each deployment/individual should be in a separate file</li>
<li>Tracking data filenames should include an ID which is the same length for all individuals</li>
<li>Tracking data must contain a timestamp and at least one other sensor column</li>
<li>Metadata file should be in the parent directory of data files</li>
<li>Metadata should contain one row per individual per deployment <em>NB: if you have multiple animal movement projects, these should have completely separate directories</em></li>
</ul>
</section>
<section id="the-importance-of-id" class="level5">
<h5>The importance of ID:</h5>
<ul>
<li>Throughout this workflow, we use ID to refer to the unique code for an individual animal</li>
<li>In certain cases, you might have additional ID columns in the metadata (e.g., <code>DeployID</code>),</li>
<li>or read in data with a unique TagID instead of ID.</li>
<li>This code will work as long as all of the relevant info is included in the metadata</li>
<li>For more info and helpful code, see the FAQ document &amp; troubleshooting script</li>
</ul>
</section>
<section id="how-to-troubleshoot-problems-if-something-doesnt-work-with-your-data" class="level5">
<h5>How to troubleshoot problems if something doesn’t work with your data:</h5>
<ul>
<li>Refer to the FAQ document in the GitHub page, which signposts to helpful resources online (e.g., CRS)</li>
<li>See the troubleshooting code scripts that we’ve written to accompany this workflow (e.g., using multiple ID columns for re-deployments of tags/individuals)</li>
<li>All functions in code chunks are automatically hyperlinked to their documentation, so feel free to explore this if you want to understand more about how this code works!</li>
</ul>
</section>
<section id="load-required-libraries" class="level5">
<h5>Load required libraries</h5>
<p>Just before starting we load in all the packages we will need for the workflow (also referenced in the <a href="#dependencies">Dependencies</a> section).</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table) <span class="co"># data manipulation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># data reading, manipulation and plotting</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># working with date-time data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co"># spatial data handling and manipulation</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># reproducible filepaths</span></span></code></pre></div>
</div>
</section>
</section>
<section id="read-in-data-files" class="level2">
<h2>1. Read in data files</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>Throughout the script, we’ll be saving files using a species code as a file/folder identifier. Our code is taken from the first letters of the species name (<strong>R</strong>ed <strong>F</strong>ooted <strong>B</strong>ooby) but can be anything you choose (shorter the better as long as it’s unique per species). Let’s define this object first for consistency:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>species_code <span class="ot">&lt;-</span> <span class="st">&quot;RFB&quot;</span></span></code></pre></div>
</div>
<p>Set filepath for the folder containing raw data files (this code will try to list and open all files matching the file pattern within this folder, so it is best if this folder contains only the raw data files). <strong><em>NB:</em></strong> <em>if you are working outside of a project, you’ll need to check that <code>{here}</code> is using the correct working directory.</em></p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>filepath <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;Data&quot;</span>, species_code)  <span class="co">#create relative filepath using folder name and species code</span></span></code></pre></div>
</div>
<p>Define common file pattern to look for. An asterisk (<code>*</code>) is the wildcard, will match any character except a forward-slash (e.g. <code>*.csv</code> will import all files that end with “.csv”).</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>filepattern <span class="ot">&lt;-</span> <span class="st">&quot;*.csv&quot;</span> <span class="co"># data file format</span></span></code></pre></div>
</div>
<p>Let’s view the file names, to check that we have the files we want &amp; find ID position (this list will include names of sub-folders).</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ls_filenames <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> filepath, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">pattern =</span> filepattern)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ls_filenames</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;GV37501_201606_DG_RFB.csv&quot; &quot;GV37503_201606_DG_RFB.csv&quot;
[3] &quot;GV37734_201807_NI_RFB.csv&quot;</code></pre>
</div>
</div>
<p>Adjust these numbers for extracting the ID number from file name using <a href="https://stringr.tidyverse.org/index.html"><code>stringr</code></a> (e.g. to extract <code>GV37501</code> from “GV37501_201606_DG_RFB.csv”, we want characters 1-7). </br> <strong><em>NB:</em></strong> <em>this approach only works if all ID’s are the same length and in the same position — see the <a href="https://stringr.tidyverse.org/reference/str_sub.html"><code>str_sub</code></a> documentation for other options.</em></p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>IDstart <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#start position of the ID in the filename </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>IDend <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="co">#end position of the ID in the filename</span></span></code></pre></div>
</div>
<p>Now, let’s inspect the data by reading in the top of the first data file as raw text. To inspect the first row of all data files (if you wanted to check column names), you can remove the <code>[1]</code> and change <code>n_max = 1</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="at">path =</span> filepath, <span class="at">recurse =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;file&quot;</span>,  <span class="at">glob =</span> filepattern)[<span class="dv">1</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_lines</span>(test, <span class="at">n_max =</span> <span class="dv">5</span>)  <span class="co"># change n_max to change the number of rows to read in</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Date, Time, Latitude, Longitude, Altitude, Speed, Course, Type, Distance&quot;
[2] &quot;24/06/2016,5.06,-7.261829,72.376091,56.18,3636,93,-2,0.00&quot;               
[3] &quot;24/06/2016, 05:21:39,-7.261829,72.376091,56.18,3636,93,0,0.00&quot;           
[4] &quot;24/06/2016, 05:29:50,-7.261744,72.376221,64.91,5112,32,0,17.17&quot;          
[5] &quot;24/06/2016, 05:54:28,-7.261623,72.376137,-15.77,936,291,0,16.34&quot;         </code></pre>
</div>
</div>
<p>Define number of lines at top of file to skip (e.g. if importing a text file with additional info at top).</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>skiplines <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
</div>
<p>Define date format(s) used (for passing to <a href="https://lubridate.tidyverse.org/reference/lubridate-package.html"><code>lubridate</code></a>) (<code>d</code> = day as decimal, <code>m</code> = month as decimal, <code>y</code> = year without century, <code>Y</code> = year with century). Parsing will work the same for different date delimiters (e.g. “dmY” will work for both <code>01-12-2022</code> and <code>01/12/2022</code>). </br> <code>lubridate</code> can even parse more than one date/time format within a dataframe, so if your data include multiple formats, make sure they are all included. Here, we’ve included some common combinations — modify if your data include a different format</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>date_formats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dmY&quot;</span>, <span class="st">&quot;Ymd&quot;</span>) <span class="co">#specify date formats </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>datetime_formats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dmY HMS&quot;</span>, <span class="st">&quot;Ymd HMS&quot;</span>) <span class="co">#specify date &amp; time format </span></span></code></pre></div>
</div>
<p>Define time zone for tracking data.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>trackingdatatimezone <span class="ot">&lt;-</span> <span class="st">&quot;GMT&quot;</span></span></code></pre></div>
</div>
<p>By default, the below code will find column names from the first row of data. If you want to specify your own column names, do so here as a character vector, or use <code>set colnames &lt;- FALSE</code> to automatically number columns.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>colnames <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
</div>
<p>Here, we use the function <code>read_delim</code> and specify the delimiter to make this code more universal (you can find extra information on this in the <a href="https://readr.tidyverse.org/reference/read_delim.html"><code>readr</code> documentation</a>).</p>
<p>Some delimiter examples:</p>
<ul>
<li><code>","</code> = comma delimited (equivalent to using <code>read_csv</code> – saved as extension <code>.csv</code>)</li>
<li><code>"\t"</code> = tab delimited (equivalent to using <code>read_tsv</code> — saved as extension <code>.tsv</code>)</li>
<li><code>" "</code> = whitespace delimited (equivalent to using <code>read_table</code>)</li>
</ul>
<p>Let’s inspect the data again, this time skipping rows if set, to check the file delimiter.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_lines</span>(test, <span class="at">n_max =</span> <span class="dv">5</span>, <span class="at">skip =</span> skiplines)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Date, Time, Latitude, Longitude, Altitude, Speed, Course, Type, Distance&quot;
[2] &quot;24/06/2016,5.06,-7.261829,72.376091,56.18,3636,93,-2,0.00&quot;               
[3] &quot;24/06/2016, 05:21:39,-7.261829,72.376091,56.18,3636,93,0,0.00&quot;           
[4] &quot;24/06/2016, 05:29:50,-7.261744,72.376221,64.91,5112,32,0,17.17&quot;          
[5] &quot;24/06/2016, 05:54:28,-7.261623,72.376137,-15.77,936,291,0,16.34&quot;         </code></pre>
</div>
</div>
<p>Set delimiter to use within <code>read_delim</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>user_delim <span class="ot">&lt;-</span> <span class="st">&quot;,&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>user_trim_ws <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Should leading/trailing whitespaces be trimmed</span></span></code></pre></div>
</div>
<p>Finally, data need an ID column, either be the tag ID (“TagID”) or individual ID (“ID”). Specify ID type here, for later matching with the same column in the metadata:</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ID_type <span class="ot">&lt;-</span> <span class="st">&quot;ID&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<section id="read-in-and-merge-all-tracking-data-files" class="level4 tabset">
<h4 class="tabset">Read in and merge all tracking data files</h4>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Merge using ID in filename</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Option: Merge using ID already in column</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>With the user inputs specified in the previous section, we’ll now read in and merge all tracking data files directly from the github repository, extracting the ID from the filename of each file.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="at">path =</span> filepath, <span class="co"># use our defined filepath</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">glob =</span> filepattern, <span class="co"># use file pattern</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&quot;file&quot;</span>,  <span class="co"># only list files</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">recurse =</span> <span class="cn">TRUE</span> <span class="co"># look inside sub-folders</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                          ) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">set_names</span>(<span class="at">nm =</span> <span class="fu">basename</span>(.)) <span class="sc">%&gt;%</span> <span class="co"># remove path prefix</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_dfr</span>(read_delim, <span class="co"># use read_delim function</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">.id =</span> <span class="st">&quot;filename&quot;</span>, <span class="co"># use filename as ID column</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&quot;c&quot;</span>), <span class="co"># as character by default</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_names =</span> colnames, <span class="co"># use colnames object made above</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">skip =</span> skiplines, <span class="co"># how many lines to skip</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">delim =</span> user_delim, <span class="co"># define delimiter</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trim_ws =</span> user_trim_ws) <span class="sc">%&gt;%</span> <span class="co"># trim characters or not</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;{ID_type}&quot;</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">str_sub</span>(<span class="at">string =</span> filename, <span class="co"># extract ID from filename </span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">start =</span> IDstart, <span class="at">end =</span> IDend), <span class="co"># ID position</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> filename) <span class="co"># move the new ID column after filename column</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>df_combined</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,650 × 12
   filename     ID    Date  Time  Latitude Longitude Altitude Speed Course Type 
   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;
 1 GV37501_201… GV37… 24/0… 5.06  -7.2618… 72.376091 56.18    3636  93     -2   
 2 GV37501_201… GV37… 24/0… 05:2… -7.2618… 72.376091 56.18    3636  93     0    
 3 GV37501_201… GV37… 24/0… 05:2… -7.2617… 72.376221 64.91    5112  32     0    
 4 GV37501_201… GV37… 24/0… 05:5… -7.2616… 72.376137 -15.77   936   291    0    
 5 GV37501_201… GV37… 24/0… 06:2… -7.2616… 72.376335 30.91    1080  124    0    
 6 GV37501_201… GV37… 24/0… 06:2… -7.2616… 72.376289 26.8     0     280    0    
 7 GV37501_201… GV37… 24/0… 06:3… -7.2615… 72.376198 21.77    0     183    0    
 8 GV37501_201… GV37… 24/0… 06:3… -7.2615… 72.376205 30.78    2844  268    0    
 9 GV37501_201… GV37… 24/0… 06:4… -7.2616… 72.376259 27.1     1476  44     0    
10 GV37501_201… GV37… 24/0… 06:4… -7.2614… 72.375732 -35.04   0     260    0    
# ℹ 6,640 more rows
# ℹ 2 more variables: Distance &lt;chr&gt;, Essential &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_combined)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] &quot;filename&quot;  &quot;ID&quot;        &quot;Date&quot;      &quot;Time&quot;      &quot;Latitude&quot;  &quot;Longitude&quot;
 [7] &quot;Altitude&quot;  &quot;Speed&quot;     &quot;Course&quot;    &quot;Type&quot;      &quot;Distance&quot;  &quot;Essential&quot;</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>If your data are combined into one or multiple csv files containing an ID column, use the following approach instead (this is the same code, but doesn’t create a new ID column from the file name):</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Option **</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df_combined <span class="ot">&lt;-</span> fs<span class="sc">::</span><span class="fu">dir_ls</span>(<span class="at">path =</span> filepath, <span class="co">#use filepath</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">glob =</span> filepattern, <span class="co"># use file pattern</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&quot;file&quot;</span>,  <span class="co"># only list files</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">recurse =</span> <span class="cn">TRUE</span> <span class="co"># look inside sub-folders</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                          ) <span class="sc">%&gt;%</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_dfr</span>(read_delim, <span class="co"># use read_delim function</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&quot;c&quot;</span>), <span class="co"># as character by default</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_names =</span> colnames, <span class="co"># use colnames object made above</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">skip =</span> skiplines, <span class="co"># how many lines to skip</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">delim =</span> user_delim, <span class="co"># define delimiter</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trim_ws =</span> user_trim_ws) <span class="co"># trim characters or not</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>df_combined</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="slim-down-dataset" class="level4 tabset">
<h4 class="tabset">Slim down dataset</h4>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Select normal columns</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Option: Select custom columns</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>First, data need a time stamp, either in separate columns (e.g., “Date” and “Time”) or combined (“DateTime”). Below we specify which column’s date and time info are stored in the data. </br> <strong><em>NB:</em></strong> <em>These have to be in the same order as specified in earlier user input, i.e. “Date” and “Time” have to be the right way round</em></p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>datetime_formats <span class="co"># previously specified datetime formats</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;dmY HMS&quot; &quot;Ymd HMS&quot;</code></pre>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>datetime_colnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Time&quot;</span>) <span class="co"># or c(&quot;DateTime&quot;) </span></span></code></pre></div>
</div>
<p>You can also have additional columns depending on the type of logger used, for example:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## lc = Argos fix quality</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Lat2/Lon2 = additional location fixes from Argos tag</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">## laterr/lonerr = location error information provided by some GLS processing packages</span></span></code></pre></div>
</div>
<p>Here we’re going to slim down the dataset by selecting the necessary columns &amp; coercing some column names. You should change column names below to those present in your tracking data, additional columns can be added (see above examples). This process standardises important column names for the rest of the workflow (e.g., <code>TagID</code>, <code>Lat</code>, <code>Lon</code>)</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df_slim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(df_combined<span class="sc">$</span>ID),</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Date =</span> df_combined<span class="sc">$</span>Date,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Time =</span> df_combined<span class="sc">$</span>Time,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Y =</span> df_combined<span class="sc">$</span>Latitude,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">X =</span> df_combined<span class="sc">$</span>Longitude)</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here’s an example of how to change the above code for data with different columns and column names. This code works with immersion data recorded by a GLS logger (no location data)</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_slim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> df_combined<span class="sc">$</span>ID,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Date =</span> df_combined<span class="sc">$</span><span class="st">`</span><span class="at">DD/MM/YYYY</span><span class="st">`</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Time =</span> df_combined<span class="sc">$</span><span class="st">`</span><span class="at">HH:MM:SS</span><span class="st">`</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Immersion =</span> df_combined<span class="sc">$</span><span class="st">`</span><span class="at">wets0-20</span><span class="st">`</span>)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="parse-dates-create-datetime-date-and-year-columns" class="level4">
<h4>Parse dates, create datetime, date and year columns</h4>
<p>Now our <code>df_slim</code> is ready, we need to create a <code>DateTime</code> column. Using the <code>datetime_colnames</code> object we made previously, we’ll combine columns (if needed), and then parse a single <code>DateTime</code> column using the <code>lubridate</code> package:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_slim <span class="ot">&lt;-</span> df_slim <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unite</span>(<span class="at">col =</span> <span class="st">&quot;DateTime_unparsed&quot;</span>, <span class="co"># united column name</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">all_of</span>(datetime_colnames), <span class="co"># which columns to unite</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep =</span> <span class="st">&quot; &quot;</span>,  <span class="co"># separator between values in new column</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">remove =</span> <span class="cn">FALSE</span> <span class="co"># remove original columns?</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">%&gt;%</span> </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DateTime =</span> lubridate<span class="sc">::</span><span class="fu">parse_date_time</span>(DateTime_unparsed, <span class="co"># parse DateTime </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">orders =</span> datetime_formats, <span class="co"># formats</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">tz =</span> trackingdatatimezone), <span class="co"># timezone</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Date =</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(DateTime),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(DateTime)) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>DateTime_unparsed)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `DateTime = lubridate::parse_date_time(...)`.
Caused by warning:
!  1 failed to parse.</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>n failed to parse</code> warnings means a date or time was not in the correct format for <code>lubridate</code> to create a date_time object, producing <code>NA</code>s. We can look at the failing rows using the following code:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Fails <span class="ot">&lt;-</span> df_slim <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(DateTime)<span class="sc">==</span>T)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Fails)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID Date Time         Y         X DateTime Year
1 GV37501 &lt;NA&gt; 5.06 -7.261829 72.376091     &lt;NA&gt;   NA</code></pre>
</div>
</div>
<p>Now we can see the issue: <code>Date</code> is empty, and <code>Time</code> is saved as a number. We’ll remove this row in the <span class="citation" data-cites="cleaning">@cleaning</span> section, so don’t need to do anything else for the moment.</p>
</div>
</div>
<p>Lastly, we make a <code>df_raw</code> dataframe by sorting using ID and DateTime, dropping NA’s in DateTime column</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df_raw <span class="ot">&lt;-</span> df_slim <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(ID_type, <span class="st">&quot;DateTime&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(DateTime) <span class="co">#remove NA&#39;s in datetime column</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID       Date     Time         Y         X            DateTime Year
1 GV37501 2016-06-24 05:21:39 -7.261829 72.376091 2016-06-24 05:21:39 2016
2 GV37501 2016-06-24 05:29:50 -7.261744 72.376221 2016-06-24 05:29:50 2016
3 GV37501 2016-06-24 05:54:28 -7.261623 72.376137 2016-06-24 05:54:28 2016
4 GV37501 2016-06-24 06:22:02 -7.261651 72.376335 2016-06-24 06:22:02 2016
5 GV37501 2016-06-24 06:27:16 -7.261618 72.376289 2016-06-24 06:27:16 2016
6 GV37501 2016-06-24 06:32:27 -7.261584 72.376198 2016-06-24 06:32:27 2016</code></pre>
</div>
</div>
<p>We can clean up intermediate files/objects by listing everything we want to keep (i.e. remove everything else)</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_raw&quot;</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;date_formats&quot;</span>,<span class="st">&quot;datetime_formats&quot;</span>,<span class="st">&quot;trackingdatatimezone&quot;</span>, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;ID_type&quot;</span>, <span class="st">&quot;species_code&quot;</span>)])</span></code></pre></div>
</div>
</section>
</section>
<section id="merge-with-metadata" class="level2">
<h2>2. Merge with metadata</h2>
<p>Metadata are an essential piece of information for any tracking study, as they contain important information about each data file, such as tag ID, animal ID, or deployment information, that we can add back into to our raw data when needed. For example, the table below shows what the first few columns of the metadata file looks like for our example red-footed booby data:</p>
<div class="cell">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-aa5e33ba{}.cl-aa5a812a{font-family:'Helvetica';font-size:8pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-aa5a813e{font-family:'Helvetica';font-size:7.5pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-aa5be2fe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-aa5becae{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becb8{width:0.931in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becb9{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becc2{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becc3{width:1.074in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becc4{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5beccc{width:1.363in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5beccd{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becce{width:1.516in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becd6{width:1.262in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becd7{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becd8{width:0.845in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bece0{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bece1{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becea{width:0.931in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5beceb{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becec{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becf4{width:1.074in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becf5{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becf6{width:1.363in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becfe{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5becff{width:1.516in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed00{width:1.262in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed08{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed09{width:0.845in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed0a{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed12{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed13{width:0.931in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed14{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed1c{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed1d{width:1.074in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed1e{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed26{width:1.363in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed27{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed28{width:1.516in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed30{width:1.262in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed31{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed32{width:0.845in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed33{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed3a{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed3b{width:0.931in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed44{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed45{width:0.863in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed46{width:1.074in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed47{width:0.633in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed48{width:1.363in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed4e{width:1.491in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed4f{width:1.516in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed50{width:1.262in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed58{width:1.287in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed59{width:0.845in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aa5bed62{width:0.99in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-aa5e33ba'><thead><tr style="overflow-wrap:break-word;"><th class="cl-aa5becae"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">TagID</span></p></th><th class="cl-aa5becb8"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">BirdID</span></p></th><th class="cl-aa5becb9"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">DeployID</span></p></th><th class="cl-aa5becc2"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">Species</span></p></th><th class="cl-aa5becc3"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">Population</span></p></th><th class="cl-aa5becc4"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">Age</span></p></th><th class="cl-aa5beccc"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">BreedingStage</span></p></th><th class="cl-aa5beccd"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">DeploymentDate</span></p></th><th class="cl-aa5becce"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">DeploymentTime</span></p></th><th class="cl-aa5becd6"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">RetrievalDate</span></p></th><th class="cl-aa5becd7"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">RetrievalTime</span></p></th><th class="cl-aa5becd8"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">NestLat</span></p></th><th class="cl-aa5bece0"><p class="cl-aa5be2fe"><span class="cl-aa5a812a">NestLong</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-aa5bece1"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">5</span></p></td><td class="cl-aa5becea"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">GV37501</span></p></td><td class="cl-aa5beceb"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">1</span></p></td><td class="cl-aa5becec"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">RFB</span></p></td><td class="cl-aa5becf4"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">DG</span></p></td><td class="cl-aa5becf5"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">Adult</span></p></td><td class="cl-aa5becf6"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">Chick rearing</span></p></td><td class="cl-aa5becfe"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">25/06/2016</span></p></td><td class="cl-aa5becff"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">16:25:00</span></p></td><td class="cl-aa5bed00"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">29/06/2016</span></p></td><td class="cl-aa5bed08"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">09:32:00</span></p></td><td class="cl-aa5bed09"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">-7.2386</span></p></td><td class="cl-aa5bed0a"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">72.4347</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-aa5bed12"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">46</span></p></td><td class="cl-aa5bed13"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">GV37503</span></p></td><td class="cl-aa5bed14"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">1</span></p></td><td class="cl-aa5bed1c"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">RFB</span></p></td><td class="cl-aa5bed1d"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">DG</span></p></td><td class="cl-aa5bed1e"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">Adult</span></p></td><td class="cl-aa5bed26"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">Chick rearing</span></p></td><td class="cl-aa5bed27"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">26/06/2016</span></p></td><td class="cl-aa5bed28"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">08:30:00</span></p></td><td class="cl-aa5bed30"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">01/07/2016</span></p></td><td class="cl-aa5bed31"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">07:55:00</span></p></td><td class="cl-aa5bed32"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">-7.2386</span></p></td><td class="cl-aa5bed33"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">72.4347</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-aa5bed3a"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">FW352Cs5</span></p></td><td class="cl-aa5bed3b"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">GV37734</span></p></td><td class="cl-aa5bed44"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">1</span></p></td><td class="cl-aa5bed45"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">RFB</span></p></td><td class="cl-aa5bed46"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">NI</span></p></td><td class="cl-aa5bed47"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">Adult</span></p></td><td class="cl-aa5bed48"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">Chick rearing</span></p></td><td class="cl-aa5bed4e"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">08/07/2018</span></p></td><td class="cl-aa5bed4f"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">09:48:00</span></p></td><td class="cl-aa5bed50"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">11/07/2018</span></p></td><td class="cl-aa5bed58"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">09:05:00</span></p></td><td class="cl-aa5bed59"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">-5.6812</span></p></td><td class="cl-aa5bed62"><p class="cl-aa5be2fe"><span class="cl-aa5a813e">72.3165</span></p></td></tr></tbody></table></div>
</div>
</div>
<section id="select-file-and-datetime-formats" class="level5">
<h5>Select file and date/time formats</h5>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>First we define the path to our metadata file:</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>filepath_meta <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;Data&quot;</span>,<span class="st">&quot;RFB_Metadata.csv&quot;</span>)</span></code></pre></div>
</div>
<p>Then much like in Step 1, we define the date format(s) used (for passing to <a href="https://lubridate.tidyverse.org/reference/lubridate-package.html"><code>lubridate</code></a>) (<code>d</code> = day as decimal, <code>m</code> = month as decimal, <code>y</code> = year without century - 2 digits, <code>Y</code> = year with century - 4 digits). Here, we’ve included common combinations, which you’ll need to modify if your metadata include a different format (run <code>OlsonNames()</code> to return a full list of time zones names).</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>metadate_formats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dmY&quot;</span>, <span class="st">&quot;Ymd&quot;</span>) <span class="co">#specify date format used in metadata</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>metadatetime_formats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dmY HMS&quot;</span>, <span class="st">&quot;Ymd HMS&quot;</span>) <span class="co">#specify date &amp; time format</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>metadatatimezone <span class="ot">&lt;-</span> <span class="st">&quot;Indian/Chagos&quot;</span> <span class="co">#specify timezone used for metadata</span></span></code></pre></div>
</div>
</div>
</div>
<p>Next we read in the metadata file (make sure to check the <code>read_</code> function you’re using matches your data format!).</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_metadata <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(filepath_meta) <span class="co"># Read in metadata file</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_metadata)</span></code></pre></div>
</div>
</section>
<section id="select-metadata-columns" class="level5">
<h5>Select metadata columns</h5>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>Then we select necessary columns &amp; create a new complete dataframe, making sure to provide four compulsory columns: <strong>ID</strong> — as defined in tracking data (individual <strong>ID</strong> or <strong>TagID</strong>), <strong>deployment date</strong> &amp; <strong>deployment time</strong>. We can also provide optional columns depending on sensor type: e.g. colony, sex, age. You can add or delete other columns where appropriate.</p>
<p>If you have multiple ID columns like TagID/DeployID, include them here (for example, if one individual was tracked over multiple deployments/years, or if one tag was re-deployed on multiple individuals). For more information and helpful code, see the <a href="FAQ&#39;s.html">FAQ document</a> and <a href="https://github.com/ExMove/ExMove/blob/main/R/Troubleshoot_Multiple%20ID%20columns.R">troubleshooting script</a>.</p>
<p><strong>Deployment and retrieval dates:</strong> Different tags types sometimes require specific approaches for dealing with data collected outside of deployment period (e.g., before deployment or after retrieval). If data need to be filtered for one or both of these scenarios, we need to sort out these columns in the metadata, and if not relevant for the data, set the column name to “NA”.</p>
<p><strong>Central Place foragers:</strong> If you are working with a central place forager (e.g., animals returning to a breeding location) and you have individual breeding location information in your metadata, here is a good place to add this info to the tracking data (e.g., breeding seabirds with known individual nest location, or seals returning to known haul-out location). We recommend adding these columns as: <code>CPY = Central place Y coordinate column</code> &amp; <code>CPX = Central place X coordinate column</code></p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_metadataslim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(df_metadata<span class="sc">$</span>BirdID), <span class="co"># compulsory column</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">TagID =</span> <span class="fu">as.character</span>(df_metadata<span class="sc">$</span>TagID),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">DeployID =</span> <span class="fu">as.character</span>(df_metadata<span class="sc">$</span>DeployID),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">DeployDate_local =</span> df_metadata<span class="sc">$</span>DeploymentDate, <span class="co"># compulsory column (make NA if irrelevant)</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">DeployTime_local =</span> df_metadata<span class="sc">$</span>DeploymentTime, <span class="co"># compulsory column (make NA if irrelevant)</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">RetrieveDate_local =</span> df_metadata<span class="sc">$</span>RetrievalDate, <span class="co"># compulsory column (make NA if irrelevant)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">RetrieveTime_local =</span> df_metadata<span class="sc">$</span>RetrievalTime, <span class="co"># compulsory column (make NA if irrelevant)</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">CPY =</span> df_metadata<span class="sc">$</span>NestLat,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">CPX =</span> df_metadata<span class="sc">$</span>NestLong,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Species =</span> <span class="st">&quot;RFB&quot;</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Population =</span> df_metadata<span class="sc">$</span>Population,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Age =</span> df_metadata<span class="sc">$</span>Age,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">BreedStage =</span> df_metadata<span class="sc">$</span>BreedingStage)</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Option: select alternative columns
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For the example dataset RFB_IMM (immature red-footed boobies), we can use the following:</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_metadataslim <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">as.character</span>(df_metadata<span class="sc">$</span>bird_id), <span class="co"># compulsory column</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">TagID =</span> <span class="fu">as.character</span>(df_metadata<span class="sc">$</span>Tag_ID),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">DeployID =</span> <span class="fu">as.character</span>(df_metadata<span class="sc">$</span>Deploy_ID),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">DeployDate_local =</span> df_metadata<span class="sc">$</span>capture_date, <span class="co"># compulsory column (set to NA if irrelevant)</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">DeployTime_local =</span> df_metadata<span class="sc">$</span>capture_time, <span class="co"># compulsory column (set to NA if irrelevant)</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">RetrieveDate_local =</span> <span class="cn">NA</span>, <span class="co"># compulsory column (set to NA if irrelevant)</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">RetrieveTime_local =</span> <span class="cn">NA</span>, <span class="co"># compulsory column (set to NA if irrelevant)</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">DeployY =</span> df_metadata<span class="sc">$</span>lat,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">DeployX =</span> df_metadata<span class="sc">$</span>long,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Species =</span> <span class="st">&quot;RFB&quot;</span>,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Age =</span> df_metadata<span class="sc">$</span>age)</span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Format all dates and times, combine them and specify timezone (NA’s in deployment/retrieval date times will throw warnings, but these are safe to ignore if you know there are NA’s in these columns).</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_metadataslim <span class="ot">&lt;-</span> df_metadataslim <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Deploydatetime =</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>           lubridate<span class="sc">::</span><span class="fu">parse_date_time</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">paste</span>(DeployDate_local, DeployTime_local),<span class="co"># make deploy datetime</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">order =</span> metadatetime_formats, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">tz =</span> metadatatimezone),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Retrievedatetime =</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>           lubridate<span class="sc">::</span><span class="fu">parse_date_time</span>(</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">paste</span>(RetrieveDate_local, RetrieveTime_local), <span class="co"># make retrieve datetime</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">order=</span>metadatetime_formats,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">tz=</span>metadatatimezone)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(<span class="fu">c</span>(<span class="st">&quot;DeployDate_local&quot;</span>, </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;DeployTime_local&quot;</span>, </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;RetrieveDate_local&quot;</span>, </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;RetrieveTime_local&quot;</span>))</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&#39;datetime&#39;</span>), <span class="co"># for chosen datetime column</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span><span class="fu">with_tz</span>(., <span class="at">tzone =</span> trackingdatatimezone)) <span class="co">#format to different tz</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
</div>
<p>Here we’ll create a dataframe of temporal extents of our data to use in absence of deploy/retrieve times (this is also useful for basic data checks and for writing up methods).</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df_temporalextents <span class="ot">&lt;-</span> df_raw <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(ID_type))) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">min_datetime =</span> <span class="fu">min</span>(DateTime),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_datetime =</span> <span class="fu">max</span>(DateTime))</span></code></pre></div>
</div>
<p>Then we use these temporal extents of our data to fill in any NA’s in the deploy/retrieve times.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df_metadataslim <span class="ot">&lt;-</span> df_metadataslim <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., df_temporalextents, <span class="at">by =</span> ID_type) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Deploydatetime =</span> <span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(Deploydatetime) <span class="sc">~</span> Deploydatetime,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">is.na</span>(Deploydatetime) <span class="sc">~</span> min_datetime),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Retrievedatetime =</span> <span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(Retrievedatetime) <span class="sc">~</span> Retrievedatetime,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">is.na</span>(Retrievedatetime) <span class="sc">~</span> max_datetime)) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(min_datetime, max_datetime))</span></code></pre></div>
</div>
<p>Next we merge metadata with raw data using the ID column.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_metamerged <span class="ot">&lt;-</span> df_raw <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(., df_metadataslim, <span class="at">by=</span>ID_type) </span></code></pre></div>
</div>
<p>Finally, we can remove intermediate files/objects by specifying objects to keep.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_metamerged&quot;</span>, <span class="st">&quot;species_code&quot;</span>)]) <span class="co">#specify objects to keep</span></span></code></pre></div>
</div>
</section>
</section>
<section id="cleaning" class="level2">
<h2>3. Cleaning</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>Define your own no/empty/erroneous data values in <code>Lat</code> and <code>Lon</code> columns (e.g. “bad” values specified by the tag manufacturer).</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>No_data_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">999</span>)</span></code></pre></div>
</div>
<p>Define a vector of columns which can’t have <code>NA</code>s (if there are <code>NA</code>s in one of these columns the problematic row will be removed).</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>na_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;DateTime&quot;</span>, <span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<p>Now we pipe the data through a series of functions to drop <code>NA</code>s in specified columns, filter out user-defined <code>no_data_values</code> in <code>Lat</code> <code>Lon</code> columns, remove duplicates, remove undeployed locations and filter out locations within temporal cut-off following deployment.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df_clean <span class="ot">&lt;-</span> df_metamerged <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(<span class="fu">all_of</span>(na_cols)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>X <span class="sc">%in%</span> No_data_vals <span class="sc">&amp;</span> <span class="sc">!</span>Y <span class="sc">%in%</span> No_data_vals) <span class="sc">%&gt;%</span> <span class="co"># remove bad Lat/Lon values</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(DateTime, ID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co"># NB: might be an issue for ACC without ms</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">case_when</span>(<span class="sc">!</span><span class="fu">is.na</span>(Retrievedatetime) <span class="co"># for all valid datetimes</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>              <span class="sc">~</span> Deploydatetime <span class="sc">&lt;</span> DateTime <span class="sc">&amp;</span> <span class="co"># keep if datetime after deployment...</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                DateTime <span class="sc">&lt;</span> Retrievedatetime, <span class="co"># ...and before retrieval</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">.default =</span> Deploydatetime <span class="sc">&lt;</span> DateTime)) <span class="co"># filter deployment only if retrieve date is NA (i.e., sat tags) </span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_clean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID       Date     Time         Y         X            DateTime Year
1 GV37501 2016-06-25 10:27:56 -7.238936 72.435043 2016-06-25 10:27:56 2016
2 GV37501 2016-06-25 10:33:13 -7.238903 72.435005 2016-06-25 10:33:13 2016
3 GV37501 2016-06-25 10:38:19 -7.238754 72.434944 2016-06-25 10:38:19 2016
4 GV37501 2016-06-25 10:43:46 -7.238957 72.435188 2016-06-25 10:43:46 2016
5 GV37501 2016-06-25 10:49:02 -7.239048 72.435059 2016-06-25 10:49:02 2016
6 GV37501 2016-06-25 10:54:38 -7.238441 72.434708 2016-06-25 10:54:38 2016
  TagID DeployID     CPY     CPX Species Population   Age    BreedStage
1     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
2     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
3     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
4     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
5     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
6     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
       Deploydatetime    Retrievedatetime
1 2016-06-25 10:25:00 2016-06-29 03:32:00
2 2016-06-25 10:25:00 2016-06-29 03:32:00
3 2016-06-25 10:25:00 2016-06-29 03:32:00
4 2016-06-25 10:25:00 2016-06-29 03:32:00
5 2016-06-25 10:25:00 2016-06-29 03:32:00
6 2016-06-25 10:25:00 2016-06-29 03:32:00</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Option: Filter by fix quality
</div>
<div class='callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end'><i class='callout-toggle'></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Argos fix quality can be used to filter the data set to remove locations with too much uncertainty. If you know the error classes that you want to retain in a dataset, you can run this filter below. </br> <strong><em>NB:</em></strong> <em>If you want to do further exploration of location quality (e.g., from GPS PTT tags to compare locations with contemporaneous GPS locations), keep all location classes by skipping this step.</em></p>
<p>In this example we define a vector of location classes to keep (typically, location classes 1, 2, and 3 are of sufficient certainty), and filter out everything else.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lc_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>df_clean <span class="ot">&lt;-</span> df_clean <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(lc <span class="sc">%in%</span> lc_keep) <span class="co"># filter data to retain only the best lc classes</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>Finally we remove intermediate files/objects:</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_clean&quot;</span>, <span class="st">&quot;species_code&quot;</span>)]) <span class="co">#specify objects to keep</span></span></code></pre></div>
</div>
</section>
<section id="processing" class="level2">
<h2>4. Processing</h2>
<section id="perform-some-useful-temporal-and-spatial-calculations-on-the-data" class="level4">
<h4>Perform some useful temporal and spatial calculations on the data</h4>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>First we need to specify the co-ordinate projection systems for the tracking data and meta data. The default here is lon/lat for both tracking data &amp; metadata, for which the EPSG code is 4326. For more information see the <a href="FAQ&#39;s.html#what-is-a-crs">CRS section of the FAQ’s</a> or have a look at the <a href="https://epsg.io/">ESPG.io database</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tracking_crs <span class="ot">&lt;-</span> <span class="dv">4326</span> <span class="co"># Only change if data are in a different coordinate system</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>meta_crs <span class="ot">&lt;-</span> <span class="dv">4326</span> <span class="co"># Only change if data are in a different coordinate system</span></span></code></pre></div>
</div>
<p>Next we transform coordinates of data, and perform spatial calculations. This requires spatial analysis, and so it is good practice to run all spatial analyses in a coordinate reference system that uses metres as a unit.</p>
<p>The default CRS for this workflow is the <a href="https://epsg.io/3857">Spherical Mercator projection</a> — (<code>crs = 3857</code>), which is used by Google Maps/OpenStreetMap and works worldwide. However, this CRS can over-estimate distance calculations in some cases, so it’s important to consider the location and scale of your data (e.g., equatorial/polar/local scale/global scale) and choose a projection system to match. Other options include (but are not limited to) UTM, and Lambert Azimuthal Equal-Area (LAEA) projections.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>transform_crs <span class="ot">&lt;-</span> <span class="dv">3857</span></span></code></pre></div>
</div>
</div>
</div>
<p>Here we’ll calculate some useful movement metrics from the tracking data, including distance between fixes, time between fixes, and net displacement from the first fix.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df_diagnostic <span class="ot">&lt;-</span>  df_clean <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="co">#need to ungroup to extract geometry of the whole dataset</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geometry_GPS =</span> <span class="fu">st_transform</span>( <span class="co"># transform X/Y coordinates</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">st_as_sf</span>(., <span class="at">coords=</span><span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>), <span class="at">crs =</span> tracking_crs), <span class="co">#from original format</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">crs =</span> transform_crs)<span class="sc">$</span>geometry <span class="co"># to the new transform_crs format</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span> <span class="co">#back to grouping by ID for calculations per individual</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist =</span> <span class="fu">st_distance</span>(geometry_GPS, <span class="co"># distance travelled from previous fix, </span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">lag</span>(geometry_GPS), </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by_element =</span> T), <span class="co"># calculations are done by row</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">difftime =</span> <span class="fu">difftime</span>(DateTime, <span class="fu">lag</span>(DateTime), <span class="co"># time passed since previous fix</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">units =</span> <span class="st">&quot;secs&quot;</span>), <span class="co"># in seconds</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">netdisp =</span> <span class="fu">st_distance</span>(geometry_GPS, <span class="co"># dist. between 1st and current location</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                               geometry_GPS[<span class="dv">1</span>], </span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">by_element =</span> F)[,<span class="dv">1</span>], <span class="co"># dense matrix w/ pairwise distances</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">speed =</span> <span class="fu">as.numeric</span>(dist)<span class="sc">/</span><span class="fu">as.numeric</span>(difftime), <span class="co"># calculate speed (distance/time)</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">dX =</span> <span class="fu">as.numeric</span>(X)<span class="sc">-</span><span class="fu">lag</span>(<span class="fu">as.numeric</span>(X)), <span class="co">#diff. in lon  relative to prev. location</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">dY =</span> <span class="fu">as.numeric</span>(Y)<span class="sc">-</span><span class="fu">lag</span>(<span class="fu">as.numeric</span>(Y)), <span class="co">#diff. in lat relative to prev. location</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">turnangle =</span> <span class="fu">atan2</span>(dX, dY)<span class="sc">*</span><span class="dv">180</span><span class="sc">/</span>pi <span class="sc">+</span> (dX <span class="sc">&lt;</span> <span class="dv">0</span>)<span class="sc">*</span><span class="dv">360</span>) <span class="sc">%&gt;%</span> <span class="co"># angle from prev. to current location</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(geometry_GPS, dX, dY)) <span class="co"># ungroup and remove excess geometries</span></span></code></pre></div>
</div>
<p>Add latitude and longitude column — this can be useful for plotting and is a common coordinate system used in the shiny app</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>df_diagnostic <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_transform</span>(<span class="fu">st_as_sf</span>(df_diagnostic, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>), </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">crs=</span>tracking_crs), </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">crs =</span> <span class="dv">4326</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rename</span>(<span class="st">&quot;Lon&quot;</span> <span class="ot">=</span> <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Lat&quot;</span> <span class="ot">=</span> <span class="st">&quot;Y&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">cbind</span>(df_diagnostic, .)</span></code></pre></div>
</div>
</section>
</section>
<section id="save-for-shiny" class="level2">
<h2>5. Save for Shiny</h2>
<p>Here we’re going to save <code>df_diagnostic</code> to use in the Shiny app provided. The app is designed to explore how further filtering and processing steps affect the data.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>First, we use <a href="https://here.r-lib.org/">here</a> to create a file path for saving the working dataframe files, and create the folder if missing</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>filepath_dfout <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;DataOutputs&quot;</span>,<span class="st">&quot;WorkingDataFrames&quot;</span>) <span class="co"># create filepath</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(filepath_dfout) <span class="co"># create folder if it doesn&#39;t exist</span></span></code></pre></div>
</div>
<p>Next we define file name for the saved file by pasting the species code before <code>_diagnostic</code> (can change this if you want to use a different naming system).</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>filename_dfout <span class="ot">&lt;-</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_diagnostic&quot;</span>)</span></code></pre></div>
</div>
<p>If not added from the metadata, add a species column and any other columns here relevant to your data <em>(optional)</em></p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ** Option ** ##</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df_diagnostic<span class="sc">$</span>Species <span class="ot">&lt;-</span> species_code</span></code></pre></div>
</div>
</div>
</div>
<p>Finally we save the <code>df_diagnostic</code> as a csv file using the variables created above.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df_diagnostic, <span class="at">file =</span> <span class="fu">here</span>(filepath_dfout, <span class="fu">paste0</span>(filename_dfout,<span class="st">&quot;.csv&quot;</span>)))</span></code></pre></div>
</div>
<p>Remove everything except <code>df_diagnostic</code> ahead of the next step.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_diagnostic&quot;</span>, <span class="st">&quot;species_code&quot;</span>)]) <span class="co">#specify objects to keep</span></span></code></pre></div>
</div>
</section>
<section id="filtering" class="level2">
<h2>6. Filtering</h2>
<p>This second filtering stage is designed to remove outliers in the data, and you can use outputs from the Shiny app to inform these choices. If you don’t need to filter for outliers, skip this step and keep using <code>df_diagnostic</code> in the next steps.</p>
<section id="shiny-app" class="level3">
<h3>Accessing the Shiny app</h3>
<section id="option-1" class="level4">
<h4>Option 1:</h4>
<p>Access the Shiny app online at the following link: <a href="https://lukeozsanlav.shinyapps.io/exmove_explorer/">https://lukeozsanlav.shinyapps.io/exmove_explorer/</a></p>
</section>
<section id="option-2" class="level4">
<h4>Option 2:</h4>
<p>Alternatively run the app from your local R session with the following code</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;shiny&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;shiny&quot;</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">runGitHub</span>(<span class="st">&quot;ExMoveApp&quot;</span>, <span class="at">username =</span> <span class="st">&quot;LukeOzsanlav&quot;</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ref =</span> <span class="st">&quot;master&quot;</span>, <span class="at">subdir =</span> <span class="st">&quot;app&quot;</span>)</span></code></pre></div>
</div>
</section>
<section id="app-usage" class="level4">
<h4>App usage:</h4>
<ul>
<li>Upload your csv version of <code>df_diagnostic</code> to the app by clicking the <code>Upload data</code> button in the top left.</li>
<li>At the bottom of each app page are printed code chunks that can be copied into subsequent user input section. These code chunks contain the user input values you manually select in the app</li>
</ul>
</section>
<section id="define-threshold-values" class="level4">
<h4>Define threshold values</h4>
<p>For this section, you can either use the code chunks produced by the Shiny app, or manually define the threshold values yourself. If you’re using the Shiny app, you can copy the code chunks from the bottom of each page to replace the user input section below. If you’re manually defining the threshold values, you can edit each of the variables below as you would for any of the user input sections (we have suggested some for the RFB dataset).</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>First we define a period to filter after tag deployment, when all points before the cutoff will be removed (e.g. to remove potentially unnatural behaviour following the tagging event). We define this period using the <code>as.period</code> function, by providing an integer value and time unit (e.g. hours/days/years). This code below specifies a period of 30 minutes:</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>filter_cutoff <span class="ot">&lt;-</span> <span class="fu">as.period</span>(<span class="dv">30</span>, <span class="at">unit=</span><span class="st">&quot;minutes&quot;</span>) </span></code></pre></div>
</div>
<p>Then we define speed threshold in m/s, which we will use to remove any points with faster speeds.</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>filter_speed <span class="ot">&lt;-</span> <span class="dv">20</span></span></code></pre></div>
</div>
<p>Next we define a net displacement (distance from first point) threshold and specify units. Any points further away from the first tracking point will be removed (see commented code for how to retain all points):</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>filter_netdisp_dist <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>filter_netdist_units <span class="ot">&lt;-</span> <span class="st">&quot;km&quot;</span> <span class="co"># e.g., &quot;m&quot;, &quot;km&quot;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">#If you want to retain points no matter the net displacement value, use these values instead:</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">#filter_netdisp_dist &lt;- max(df_diagnostic$netdisp)</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#filter_netdist_units &lt;- &quot;m&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<section id="implement-filters" class="level5">
<h5>Implement filters</h5>
<p>Create net displacement filter using distance and units</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>filter_netdisp <span class="ot">&lt;-</span> units<span class="sc">::</span><span class="fu">as_units</span>(filter_netdisp_dist, filter_netdist_units)</span></code></pre></div>
</div>
<p>Filter df_diagnostic</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df_filtered <span class="ot">&lt;-</span> df_diagnostic <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Deploydatetime <span class="sc">+</span> filter_cutoff <span class="sc">&lt;</span> DateTime, <span class="co"># keep times after cutoff</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>         speed <span class="sc">&lt;</span> filter_speed, <span class="co"># keep speeds slower than speed filter</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>         netdisp <span class="sc">&lt;=</span> filter_netdisp) <span class="co"># keep distances less than net displacement filter</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_filtered)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID       Date     Time         Y         X            DateTime Year
1 GV37501 2016-06-25 11:01:04 -7.238462 72.434708 2016-06-25 11:01:04 2016
2 GV37501 2016-06-25 11:08:50 -7.238486 72.434738 2016-06-25 11:08:50 2016
3 GV37501 2016-06-25 11:17:13 -7.238597 72.435005 2016-06-25 11:17:13 2016
4 GV37501 2016-06-25 11:25:16 -7.231193 72.434624 2016-06-25 11:25:16 2016
5 GV37501 2016-06-25 11:30:32  -7.23855 72.434731 2016-06-25 11:30:32 2016
6 GV37501 2016-06-25 11:36:43 -7.238533 72.434761 2016-06-25 11:36:43 2016
  TagID DeployID     CPY     CPX Species Population   Age    BreedStage
1     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
2     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
3     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
4     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
5     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
6     5        1 -7.2386 72.4347     RFB         DG Adult Chick rearing
       Deploydatetime    Retrievedatetime           dist difftime       netdisp
1 2016-06-25 10:25:00 2016-06-29 03:32:00   2.356490 [m] 386 secs  64.96002 [m]
2 2016-06-25 10:25:00 2016-06-29 03:32:00   4.290196 [m] 466 secs  60.84931 [m]
3 2016-06-25 10:25:00 2016-06-29 03:32:00  32.226707 [m] 503 secs  38.27498 [m]
4 2016-06-25 10:25:00 2016-06-29 03:32:00 831.906239 [m] 483 secs 870.11594 [m]
5 2016-06-25 10:25:00 2016-06-29 03:32:00 825.636254 [m] 316 secs  55.51973 [m]
6 2016-06-25 10:25:00 2016-06-29 03:32:00   3.846024 [m] 371 secs  55.05007 [m]
        speed turnangle      Lon       Lat
1 0.006104896 180.00000 72.43471 -7.238462
2 0.009206429 128.65981 72.43474 -7.238486
3 0.064069000 112.57414 72.43501 -7.238597
4 1.722373165 357.05423 72.43462 -7.231193
5 2.612772957 179.16675 72.43473 -7.238550
6 0.010366640  60.46122 72.43476 -7.238533</code></pre>
</div>
</div>
<p>Remove intermediate files/objects</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_filtered&quot;</span>, <span class="st">&quot;species_code&quot;</span>)]) <span class="co">#specify objects to keep</span></span></code></pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="summarise-data" class="level2">
<h2>7. Summarise cleaned &amp; filtered tracking data</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>Set the units to display sampling rate in the summary table</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sampleRateUnits <span class="ot">&lt;-</span> <span class="st">&quot;mins&quot;</span> </span></code></pre></div>
</div>
<section id="define-levels-of-grouping-factors-to-summarise-over" class="level5">
<h5>Define levels of grouping factors to summarise over</h5>
<p>Firstly, down to population level. Here, we are working on data from one population &amp; year, and so use <code>Species</code> as the grouping factor. Add any other relevant grouping factors here (e.g. Country / Year / Season / Age).</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>grouping_factors_poplevel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Species&quot;</span>)</span></code></pre></div>
</div>
<p>Secondly, down to individual level (add <code>DeployID</code> for example if relevant).</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>grouping_factors_indlevel <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
</div>
</section>
</div>
</div>
<section id="create-summary-tables" class="level5">
<h5>Create summary tables</h5>
<p>Create a small function to calculate standard error.</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">var</span>(x, <span class="at">na.rm =</span> T) <span class="sc">/</span> <span class="fu">length</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)]))</span></code></pre></div>
</div>
<p>Create a summary table of individual-level summary statistics:</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df_summary_ind <span class="ot">&lt;-</span> df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="fu">all_of</span>(grouping_factors_poplevel), <span class="fu">all_of</span>(grouping_factors_indlevel)))) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">NoPoints =</span> <span class="fu">NROW</span>(ID), <span class="co"># number of fixes</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">NoUniqueDates =</span> <span class="fu">length</span>(<span class="fu">unique</span>(Date)), <span class="co"># number of tracking dates</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">FirstDate =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(Date)), <span class="co"># first tracking date</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">LastDate =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(Date)), <span class="co"># last tracking date</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">SampleRate =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(difftime, <span class="at">units =</span> sampleRateUnits), <span class="at">na.rm =</span> T), <span class="co"># sample rate mean</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">SampleRate_se =</span> <span class="fu">se</span>(<span class="fu">as.numeric</span>(difftime, <span class="at">units =</span> sampleRateUnits))) <span class="co"># sample rate standard error</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by &#39;Species&#39;. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df_summary_ind</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
# Groups:   Species [1]
  Species ID      NoPoints NoUniqueDates FirstDate  LastDate   SampleRate
  &lt;chr&gt;   &lt;chr&gt;      &lt;int&gt;         &lt;int&gt; &lt;date&gt;     &lt;date&gt;          &lt;dbl&gt;
1 RFB     GV37501      989             5 2016-06-25 2016-06-29       5.37
2 RFB     GV37503     1280             6 2016-06-26 2016-07-01       5.58
3 RFB     GV37734      820             4 2018-07-08 2018-07-11       5.18
# ℹ 1 more variable: SampleRate_se &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Create a table of population-level summary statistics:</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>df_summary_pop <span class="ot">&lt;-</span> df_summary_ind <span class="sc">%&gt;%</span> <span class="co"># use the individual-level summary data</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(grouping_factors_poplevel)) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">NoInds =</span> <span class="fu">length</span>(<span class="fu">unique</span>(ID)), <span class="co"># number of unique individuals</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">NoPoints_total =</span> <span class="fu">sum</span>(NoPoints), <span class="co"># total number of tracking locations</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">FirstDate =</span> <span class="fu">as.Date</span>(<span class="fu">min</span>(FirstDate)), <span class="co"># first tracking date</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">LastDate =</span> <span class="fu">as.Date</span>(<span class="fu">max</span>(LastDate)), <span class="co"># last tracking date</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">PointsPerBird =</span> <span class="fu">mean</span>(NoPoints), <span class="co"># number of locations per individual: mean</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">PointsPerBird_se =</span> <span class="fu">se</span>(NoPoints), <span class="co"># number of locations per individual: standard error</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">DatesPerBird =</span> <span class="fu">mean</span>(NoUniqueDates), <span class="co"># number of tracking days per bird: mean</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">DatesPerBird_se =</span> <span class="fu">se</span>(NoUniqueDates), <span class="co"># number of tracking days per bird: standard error</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">SampleRate_mean =</span> <span class="fu">mean</span>(SampleRate), <span class="co"># sample rate mean</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">SampleRate_se =</span> <span class="fu">se</span>(SampleRate)) <span class="co"># sample rate standard error</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>df_summary_pop</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 11
  Species NoInds NoPoints_total FirstDate  LastDate   PointsPerBird
  &lt;chr&gt;    &lt;int&gt;          &lt;int&gt; &lt;date&gt;     &lt;date&gt;             &lt;dbl&gt;
1 RFB          3           3089 2016-06-25 2018-07-11         1030.
# ℹ 5 more variables: PointsPerBird_se &lt;dbl&gt;, DatesPerBird &lt;dbl&gt;,
#   DatesPerBird_se &lt;dbl&gt;, SampleRate_mean &lt;dbl&gt;, SampleRate_se &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Remove intermediate files/objects by specifying which objects to keep:</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_filtered&quot;</span>,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;df_summary_ind&quot;</span>, <span class="st">&quot;df_summary_pop&quot;</span>, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;species_code&quot;</span>)]) </span></code></pre></div>
</div>
</section>
</section>
<section id="save-data" class="level2">
<h2>8. Save filtered and summary data</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
🧠 User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>First we define the folder file path for saving our filtered data and create folder if not already present</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>filepath_filtered_out <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;DataOutputs&quot;</span>,<span class="st">&quot;WorkingDataFrames&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(filepath_filtered_out)</span></code></pre></div>
</div>
<p>Then we define the file path for saving summary dataframes, again creating folder if needed</p>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>filepath_summary_out <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;DataOutputs&quot;</span>,<span class="st">&quot;SummaryDataFrames&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(filepath_summary_out)</span></code></pre></div>
</div>
<p>Here we define file names for saved files, and paste the species code to <code>_summary_</code>, followed by <code>ind</code> (individual level) or <code>pop</code> (population level). You can change this if you want to use a different naming system.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>filename_filtered_out <span class="ot">&lt;-</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_filtered&quot;</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>filename_summary_ind_out <span class="ot">&lt;-</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_summary_ind&quot;</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>filename_summary_pop_out <span class="ot">&lt;-</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_summary_pop&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<p>Now we can save all our dataframes as .csv files using our defined values</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df_filtered, <span class="at">file =</span> <span class="fu">here</span>(filepath_filtered_out, <span class="fu">paste0</span>(filename_filtered_out,<span class="st">&quot;.csv&quot;</span>)))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df_summary_ind, <span class="at">file =</span> <span class="fu">here</span>(filepath_summary_out, <span class="fu">paste0</span>(filename_summary_ind_out,<span class="st">&quot;.csv&quot;</span>)))</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df_summary_pop, <span class="at">file =</span> <span class="fu">here</span>(filepath_summary_out, <span class="fu">paste0</span>(filename_summary_pop_out,<span class="st">&quot;.csv&quot;</span>)))</span></code></pre></div>
</div>
<p>Lastly we remove intermediate files/objects</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;df_filtered&quot;</span>, </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;df_summary_ind&quot;</span>, <span class="st">&quot;df_summary_pop&quot;</span>, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;species_code&quot;</span>)])</span></code></pre></div>
</div>
</section>
<section id="visualisation" class="level2">
<h2>9. Visualisation</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon no-icon'></i>
</div>
<div class="callout-title-container flex-fill">
User input required
</div>
</div>
<div class="callout-body-container callout-body">
<p>Define parameters for reading out plots, and define device to read plots out as e.g. tiff/jpeg</p>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>device <span class="ot">&lt;-</span> <span class="st">&quot;tiff&quot;</span></span></code></pre></div>
</div>
<p>Define units for plot size (usually mm)</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="st">&quot;mm&quot;</span></span></code></pre></div>
</div>
<p>Define plot resolution in dpi (300 is usually good minimum)</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dpi <span class="ot">&lt;-</span> <span class="dv">300</span></span></code></pre></div>
</div>
<p>Define filepath to read out plots and create folder if absent</p>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>out_path <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;DataOutputs&quot;</span>,<span class="st">&quot;Figures&quot;</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(out_path)</span></code></pre></div>
</div>
<p>We plot maps over a topography base-layer which can include terrestrial (elevation) and marine (bathymetry/water depth) data. To set legend label for topography data, relevant to your data.</p>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>topo_label <span class="ot">=</span> <span class="st">&quot;Depth (m)&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<p>Load additional libraries for spatial visualisation <strong>(optional)</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
If you see a <code>masking</code> warning these are fine. Watch out for packages that aren’t installed yet
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marmap)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code></pre></div>
</div>
</div>
</div>
<p>Create version of data for plotting by transforming required columns to numeric and creating time elapsed columns</p>
<div class="cell">
<div class="sourceCode" id="cb92"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>df_plotting <span class="ot">&lt;-</span> df_filtered <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diffsecs =</span> <span class="fu">as.numeric</span>(difftime),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">secs_elapsed =</span> <span class="fu">cumsum</span>(<span class="fu">replace_na</span>(diffsecs, <span class="dv">0</span>)),</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_elapsed =</span> <span class="fu">as.duration</span>(secs_elapsed),</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">days_elapsed =</span> <span class="fu">as.numeric</span>(time_elapsed, <span class="st">&quot;days&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(dist,speed, Lat, Lon), as.numeric))</span></code></pre></div>
</div>
<p>Create a map of all points. Set the plot limits as the max and min lat/longs as the tracking data</p>
<p>First set up a basemap to plot over: - Use <code>rnaturalearth</code> low resolution countries basemap - co-ordinates in lat/lon to match other spatial data</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span></code></pre></div>
</div>
<p>Define min and max co-ordinates based on extent of tracking data, for adding bathymetry extracted from NOAA database.</p>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>minlon <span class="ot">&lt;-</span> <span class="fu">min</span>(df_plotting<span class="sc">$</span>Lon)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>maxlon <span class="ot">&lt;-</span> <span class="fu">max</span>(df_plotting<span class="sc">$</span>Lon)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>minlat <span class="ot">&lt;-</span> <span class="fu">min</span>(df_plotting<span class="sc">$</span>Lat)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>maxlat <span class="ot">&lt;-</span> <span class="fu">max</span>(df_plotting<span class="sc">$</span>Lat)</span></code></pre></div>
</div>
<p>Load in bathymetry basemap. Set limits slightly beyond tracking data to make a buffer so no gaps when plotting</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>base_topography_map <span class="ot">&lt;-</span> <span class="fu">getNOAA.bathy</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon1 =</span> minlon <span class="sc">-</span> <span class="fl">0.1</span>, <span class="at">lon2 =</span> maxlon <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat1 =</span> minlat <span class="sc">-</span> <span class="fl">0.1</span>, <span class="at">lat2 =</span> maxlat <span class="sc">+</span> <span class="fl">0.1</span>, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">resolution =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<p>Fortify bathymetry data for plotting</p>
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>base_topography_fort <span class="ot">=</span> <span class="fu">fortify</span>(base_topography_map)</span></code></pre></div>
</div>
<p>Create base map with correct extent, topography, country outlines, etc.,</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>map_base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> base_topography_fort, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>z), <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add colour scheme for the fill</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option=</span><span class="st">&quot;mako&quot;</span>, <span class="at">name =</span> topo_label) <span class="sc">+</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add map of countries over the top</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> countries, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set plot limits</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(minlon<span class="fl">-0.1</span>, maxlon<span class="fl">+0.1</span>), </span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> <span class="fu">c</span>(minlat<span class="fl">-0.1</span>, maxlat<span class="fl">+0.1</span>), <span class="at">crs =</span> <span class="dv">4326</span>, <span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>) <span class="sc">+</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>),</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.7</span>),</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.7</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set a theme</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>map_base</span></code></pre></div>
<div class="cell-output-display">
<p><img src="User_guide_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Population</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Several individuals</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Option: Many individuals</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Plot a combined map of all tracking locations:</p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>map_alllocs <span class="ot">&lt;-</span> map_base <span class="sc">+</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add GPS points</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_plotting, </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Lon, <span class="at">y =</span> Lat), </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&quot;violetred3&quot;</span>) </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>map_alllocs</span></code></pre></div>
<div class="cell-output-display">
<p><img src="User_guide_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Plot a map of individual locations, colouring points by speed, and faceting by ID</p>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>map_individuals <span class="ot">&lt;-</span> map_base <span class="sc">+</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add GPS points and paths between them</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_plotting, </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Lon, <span class="at">y =</span> Lat, <span class="at">col =</span> speed), </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span> </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df_plotting, </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Lon, <span class="at">y =</span> Lat, <span class="at">col =</span> speed), </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span> </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colour birds using scale_colour_gradient2</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradient2</span>(<span class="at">name =</span> <span class="st">&quot;Speed&quot;</span>, </span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">midpoint =</span> (<span class="fu">max</span>(df_plotting<span class="sc">$</span>speed,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="co"># use `midpoint` for nice colour transition</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>                         ) <span class="sc">+</span> </span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID, <span class="co"># facet for individual</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">n_distinct</span>(df_plotting<span class="sc">$</span>ID))))  </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>map_individuals</span></code></pre></div>
<div class="cell-output-display">
<p><img src="User_guide_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>In previous plots, we’ve split the population into individual facets. This works fine on the example code, where we only have a few individuals, but if you have more individuals and the facets are too small, you can split the plot onto multiple pages. Use the below code to use <code>facet_wrap_paginate</code> from the <code>ggforce</code> package:</p>
<div class="cell" data-messages="false">
<div class="sourceCode" id="cb102"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ** Option ** ##</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="do">## save plot as object to later extract number of pages</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="do">## e.g., with 2 per page:</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>map_individuals <span class="ot">&lt;-</span> map_base <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_plotting, <span class="co"># add GPS points</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Lon, <span class="at">y =</span> Lat, <span class="at">col =</span> speed), </span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span> </span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> df_plotting, <span class="co">#and paths between them</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Lon, <span class="at">y =</span> Lat, <span class="at">col =</span> speed), </span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="fl">0.5</span> </span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradient2</span>(<span class="at">name =</span> <span class="st">&quot;Speed&quot;</span>, <span class="co"># colour speed w/ scale_colour_gradient2</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">midpoint =</span> (<span class="fu">max</span>(df_plotting<span class="sc">$</span>speed,<span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>                         ) <span class="sc">+</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap_paginate</span>(<span class="sc">~</span>ID, <span class="co"># facet for individual</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow=</span> <span class="dv">1</span>, <span class="at">page =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<p>How many pages of plots?</p>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_pages</span>(map_individuals)</span></code></pre></div>
</div>
<p>Run through different values of page to show each page in turn</p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>map_individuals</span></code></pre></div>
</div>
</div>
</div>
</div>
<p>Save maps for further use using <code>ggsave</code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> map_alllocs, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_map_all_locs.&quot;</span>, device),</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> device,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> out_path, </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> units, <span class="at">width =</span> <span class="dv">200</span>, <span class="at">height =</span> <span class="dv">175</span>, <span class="at">dpi =</span> dpi,   </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> map_individuals, </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_map_individuals.&quot;</span>, device),</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> device,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> out_path, </span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> units, <span class="at">width =</span> <span class="dv">200</span>, <span class="at">height =</span> <span class="dv">175</span>, <span class="at">dpi =</span> dpi,   </span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p>Create a time series plot of speed, faceted for each individual.</p>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>speed_time_plot <span class="ot">&lt;-</span> df_plotting <span class="sc">%&gt;%</span> <span class="co">#speed over time</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> days_elapsed, <span class="at">y =</span> speed, <span class="at">group =</span> ID)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span>   <span class="co"># add line of speed over time</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;time elapsed (days)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;speed (m/s)&quot;</span>) <span class="sc">+</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID, <span class="co"># facet by individual</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">n_distinct</span>(df_plotting<span class="sc">$</span>ID)))) <span class="sc">+</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="co"># set plotting theme</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>)) <span class="co">#adjust theme</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>speed_time_plot</span></code></pre></div>
<div class="cell-output-display">
<p><img src="User_guide_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class='callout-icon'></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Warnings about <code>non-finite</code> values for speed/step length plots are expected and usually refer to the first location for each individual (i.e. number of non-finite values should be equal to number of individuals)</p>
</div>
</div>
<p>Save plot for further use</p>
<div class="cell">
<div class="sourceCode" id="cb107"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> speed_time_plot, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_speed_timeseries_plot.&quot;</span>, device),</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> device,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> out_path, </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> units, <span class="at">width =</span> <span class="dv">200</span>, <span class="at">height =</span> <span class="dv">175</span>, <span class="at">dpi =</span> dpi  </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p>Create a histogram of point to point speeds (can adjust binwidth and x limits manually)</p>
<div class="cell">
<div class="sourceCode" id="cb108"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>speed_hist <span class="ot">&lt;-</span> df_plotting <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(speed)) <span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span> <span class="co"># can adjust binwidth to suite your needs</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span>..count..)) <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;speed (m/s)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID, <span class="co"># facet by individual</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">n_distinct</span>(df_plotting<span class="sc">$</span>ID)))) <span class="sc">+</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="co"># set plotting theme</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>)) <span class="co">#adjust theme</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>speed_hist</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="User_guide_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
<p>Save plot for further use</p>
<div class="cell">
<div class="sourceCode" id="cb110"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> speed_hist, </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_speed_histogram&quot;</span>, device),</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> device,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> out_path,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> units, <span class="at">width =</span> <span class="dv">200</span>, <span class="at">height =</span> <span class="dv">175</span>, <span class="at">dpi =</span> dpi,   </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p>Create a time series plot of step lengths (faceted for each individual)</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>step_time_plot <span class="ot">&lt;-</span> df_plotting <span class="sc">%&gt;%</span> <span class="co">#step length over time</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> days_elapsed, <span class="at">y =</span> <span class="fu">as.numeric</span>(netdisp), <span class="at">group =</span> ID)) <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add plot labels</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;time elapsed (days)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Distance from first fix (m)&quot;</span>) <span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID, <span class="co"># facet by individual</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow=</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">n_distinct</span>(df_plotting<span class="sc">$</span>ID)))) <span class="sc">+</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="co"># set plotting theme</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>)) <span class="co">#adjust theme</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>step_time_plot</span></code></pre></div>
<div class="cell-output-display">
<p><img src="User_guide_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="672" /></p>
</div>
</div>
<p>Save plot for further use</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> step_time_plot, </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_step_time_plot.&quot;</span>, device),</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> device,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> out_path,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> units, <span class="at">width =</span> <span class="dv">200</span>, <span class="at">height =</span> <span class="dv">175</span>, <span class="at">dpi =</span> dpi,   </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p>Create a histogram of step lengths (can adjust binwidth and x limits manually)</p>
<div class="cell">
<div class="sourceCode" id="cb113"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>step_hist <span class="ot">&lt;-</span> df_plotting <span class="sc">%&gt;%</span> <span class="co">#step histogram</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="fu">as.numeric</span>(dist))) <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> <span class="co"># can adjust binwidth to suite your needs</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">1</span><span class="sc">*</span>..count..)) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;step length (m)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ID, <span class="co"># facet by individual</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">n_distinct</span>(df_plotting<span class="sc">$</span>ID))))<span class="sc">+</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="co"># set plotting theme</span></span></code></pre></div>
</div>
<p>Save plot for further use</p>
<div class="cell">
<div class="sourceCode" id="cb114"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot =</span> step_hist, </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> <span class="fu">paste0</span>(species_code, <span class="st">&quot;_step_hist.&quot;</span>, device),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">device =</span> device,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">path =</span> out_path,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> units, <span class="at">width =</span> <span class="dv">200</span>, <span class="at">height =</span> <span class="dv">175</span>, <span class="at">dpi =</span> dpi,   </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<p>Lastly, we remove intermediate files/objects if necessary to speed up any post-processing steps</p>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;species_code&quot;</span>)]) <span class="co">#specify objects to keep</span></span></code></pre></div>
</div>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">ExMove</span> <span class="hidden" data-render-id="quarto-int-navbar-title">ExMove</span> <span class="hidden" data-render-id="quarto-int-navbar:Home">Home</span> <span class="hidden" data-render-id="quarto-int-navbar:/index.html">/index.html</span> <span class="hidden" data-render-id="quarto-int-navbar:User guide">User guide</span> <span class="hidden" data-render-id="quarto-int-navbar:/User_guide.html">/User_guide.html</span> <span class="hidden" data-render-id="quarto-int-navbar:Glossary">Glossary</span> <span class="hidden" data-render-id="quarto-int-navbar:/Glossary.html">/Glossary.html</span> <span class="hidden" data-render-id="quarto-int-navbar:FAQ&#39;s">FAQ’s</span> <span class="hidden" data-render-id="quarto-int-navbar:/FAQs.html">/FAQs.html</span> <span class="hidden" data-render-id="quarto-int-navbar:https://github.com/ExMove/ExMove">https://github.com/ExMove/ExMove</span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">ExMove - ExMove user guide</span> <span class="hidden" data-render-id="quarto-twittercardtitle">ExMove - ExMove user guide</span> <span class="hidden" data-render-id="quarto-ogcardtitle">ExMove - ExMove user guide</span> <span class="hidden" data-render-id="quarto-metasitename">ExMove</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->

</body>

</html>